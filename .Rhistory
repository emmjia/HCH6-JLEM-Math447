# creating data table
type <- rep(c("Glass", "Plastic"), times = 4)
worker <- rep(c("1", "2"), each = 2, times = 2) # pick up here
router.aov = aov(Vibes ~ coded(A) * coded(B), router.long)
# creating data table
A <- rep(c("-","+","-","+"), times = 4)
B <- rep(c("-","-","+","+"), times = 4)
Rep <- rep(c("I","II","III","IV"), each = 4)
Vibes <- c(18.2, 27.2, 15.9, 41.0, 18.9, 24.0, 14.5, 43.9, 12.9, 22.4, 15.1, 36.3, 14.4, 22.5, 14.2, 39.9)
router.long <- data.frame(A, B, Rep, Vibes)
# defining coded
coded=function(x) #a function to code variable x
{
ifelse(x=="+", 1, -1)
}
# linear regression
router.lm=lm(Vibes ~ coded(A) * coded(B), router.long)
summary(router.lm)
router.aov = aov(Vibes ~ coded(A) * coded(B), router.long)
qqnorm(router.aov, full=T,label=T)
router.aov = aov(Vibes ~ coded(A) * coded(B), router.long)
qqnorm(router.aov, full=T,label=T)
router.aov = aov(Vibes ~ coded(A) * coded(B), router.long)
qqnorm(router.aov, full=T,label=T)
qqnorm(router.aov, full=T,label=T)
router.aov = aov(Vibes ~ coded(A) * coded(B), router.long)
qqnorm(router.aov, full=T,label=T)
# creating data table
A <- rep(c("-","+","-","+"), times = 4)
B <- rep(c("-","-","+","+"), times = 4)
Rep <- rep(c("I","II","III","IV"), each = 4)
Vibes <- c(18.2, 27.2, 15.9, 41.0, 18.9, 24.0, 14.5, 43.9, 12.9, 22.4, 15.1, 36.3, 14.4, 22.5, 14.2, 39.9)
router.long <- data.frame(A, B, Rep, Vibes)
# defining coded
coded=function(x) #a function to code variable x
{
ifelse(x=="+", 1, -1)
}
# linear regression
router.lm=lm(Vibes ~ coded(A) * coded(B), router.long)
summary(router.lm)
router.aov = aov(Vibes ~ coded(A) * coded(B), router.long)
qqnorm(router.aov, full=T,label=T)
qqnorm(router.aov, full=T)
letter = c(A,B,C,D,AB,AC,AD,BC,BD,CD,ABC,ABD,ACD,BCD,ABCD)
letter = c("A","B","C","D","AB","AC","AD","BC","BD","CD","ABC","ABD","ACD","BCD","ABCD")
number = c(76.95,-67.52,-7.84,-18.73,-51.32,11.69,9.78,20.79,14.74,1.27,-2.82,-6.50,10.20,-7.98,-6.25)
experiment = data.frame(letter, number)
View(experiment)
View(experiment)
experimentaov = aov(number ~ letter, experiment)
summary(experimentaov)
experiment.aov = aov(number ~ coded(letter), experiment)
summary(experiment.aov)
qqnorm(experiment.aov, full=T,label=T)
library("gplots")
qqnorm(experiment.aov, full=T,label=T)
################################################
#    normal and half-normal probability plot  ##
################################################
#plasma example continued
#normal probability plot
qqnorm(plasma.aov, full=T,label=T)
#################################
##     2^3    design            #
#################################
plasma=read.table("C:/Users/Emmanuel/Desktop/SPRING 2018/MATH 447/Chapter 6/plasma.txt", header = TRUE)
plasmaLong=reshape(plasma, varying = c("Rep1", "Rep2"), v.names = "Rate",
direction = "long", timevar = "Rep")
#aova
plasma.aov=aov(Rate ~ A * B * C, plasmaLong)
summary(plasma.aov)
mse=summary(plasma.aov)[[1]][8,3]
mse
##create response surfaces
plasmaLong=within(plasmaLong, {cA = coded(A); cC = coded(C)})
plasma.lm1=lm(Rate ~ cA+cC+cA*cC, plasmaLong)
ngrid=20
u=1
Agrid=seq(from = -u, to = u, length = ngrid)
Cgrid=seq(from = -u, to = u, length = ngrid)
grid=expand.grid(cA=Agrid, cC=Cgrid)
yhat=predict(plasma.lm1, grid)
yhat=matrix(yhat, length(Agrid), length(Cgrid))
persp(Agrid, Cgrid, yhat, theta = -40, phi = 30)
View(plasmaLong)
################################################
#    normal and half-normal probability plot  ##
################################################
#plasma example continued
#normal probability plot
qqnorm(plasma.aov, full=T,label=T)
letter = c("A","B","C","D","AB","AC","AD","BC","BD","CD","ABC","ABD","ACD","BCD","ABCD")
number = c(76.95,-67.52,-7.84,-18.73,-51.32,11.69,9.78,20.79,14.74,1.27,-2.82,-6.50,10.20,-7.98,-6.25)
experiment = data.frame(letter, number)
experiment.aov = aov(number ~ coded(letter), experiment)
qqnorm(experiment.aov, full=T,label=T)
## click at the "outlier" points and then click "Finish" button
coef=plasma.lm$coefficients[-1]
variables=names(coef)
plot=qqnorm(coef)
variables[identify(plot)]
# loading libraries
library(car)
qqnorm(experiment.aov, full=T,label=T)
View(experiment)
qqnorm(abs(number), full=T,label=T)
qqnorm(abs(number))
, full=T,label=T
qqnorm(abs(number), full=T,label=T)
qqnorm(abs(number), full=T,label=T)
plot = qqnorm(abs(number), full=T,label=T)
variables[identify(plot)]
plot = qqnorm(abs(number))
variables[identify(plot)]
plot = qqnorm(abs(number))
variables[identify(plot)]
library(gplots)
variables[identify(plot)]
View(plasmaLong)
## click at the "outlier" points and then click "Finish" button
qqnorm(aov(number ~ A * B * C * D, experiment), label=T)
list = abs(number)
list
sort(list)
qq(list)
qqplot(list)
qqplot(list, experiment)
lister = abs(number)
sort(lister)
qqplot(lister)
qqplot(lister, experiment)
lister = sort(abs(number))
qqplot(lister)
qqplot(lister, experiment)
qqnorm(lister)
abline(h = 76.95)
abline(v = 76.95)
qqnorm(lister)
abline(v = 76.95)
letter = c("A","B","C","D","AB","AC","AD","BC","BD","CD","ABC","ABD","ACD","BCD","ABCD")
number = c(76.95,-67.52,-7.84,-18.73,-51.32,11.69,9.78,20.79,14.74,1.27,-2.82,-6.50,10.20,-7.98,-6.25)
experiment = data.frame(letter, number)
experiment.aov = aov(number ~ coded(letter), experiment)
plot = qqnorm(abs(number))
## click at the "outlier" points and then click "Finish" button
qqnorm(aov(number ~ A * B * C * D, experiment), label=T)
lister = sort(abs(number))
qqnorm(lister)
abline(v = 76.95)
abline(v = 76.95, col="red")
abline(h = 76.95, col="red")
abline(h = 76.95, col = "red")
letter = c("A","B","C","D","AB","AC","AD","BC","BD","CD","ABC","ABD","ACD","BCD","ABCD")
number = c(76.95,-67.52,-7.84,-18.73,-51.32,11.69,9.78,20.79,14.74,1.27,-2.82,-6.50,10.20,-7.98,-6.25)
experiment = data.frame(letter, number)
experiment.aov = aov(number ~ coded(letter), experiment)
plot = qqnorm(abs(number))
## click at the "outlier" points and then click "Finish" button
qqnorm(aov(number ~ A * B * C * D, experiment), label=T)
letter = c("A","B","C","D","AB","AC","AD","BC","BD","CD","ABC","ABD","ACD","BCD","ABCD")
number = c(76.95,-67.52,-7.84,-18.73,-51.32,11.69,9.78,20.79,14.74,1.27,-2.82,-6.50,10.20,-7.98,-6.25)
experiment = data.frame(letter, number)
experiment.aov = aov(number ~ coded(letter), experiment)
plot = qqnorm(abs(number))
## click at the "outlier" points and then click "Finish" button
lister = sort(abs(number))
qqnorm(lister)
abline(h = 76.95, col = "red")
lister = sort(abs(number))
lister
qqnorm(lister)
abline(h = 76.95, col = "red")
abline(h = 67.52, col = "purple")
abline(h = 51.32, col = "blue")
letter = c("A","B","C","D","AB","AC","AD","BC","BD","CD","ABC","ABD","ACD","BCD","ABCD")
number = c(76.95,-67.52,-7.84,-18.73,-51.32,11.69,9.78,20.79,14.74,1.27,-2.82,-6.50,10.20,-7.98,-6.25)
experiment = data.frame(letter, number)
experiment.aov = aov(number ~ coded(letter), experiment)
plot = qqnorm(abs(number))
## click at the "outlier" points and then click "Finish" button
lister = sort(abs(number))
qqnorm(lister)
abline(h = 76.95, col = "red")
abline(h = 67.52, col = "purple")
abline(h = 51.32, col = "blue")
